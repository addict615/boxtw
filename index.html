<html lang="zh-TW">
<head>
  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.1.0/jquery.min.js"></script>
  
  <link href="style.css" rel="stylesheet">
  <title>票房test</title>
  </head>

 <body>
<nav class="navbar navbar-dark bg-dark">
    <div class="container"> 
      <a class="navbar-brand" href="index.html">票房test</a>
    </div>
  </nav>   


<div id="weekly_table" style="margin:20px"></div>

 <script>
 var employeeData;
$(document).ready(function(){
  $.getJSON( "https://sheets.googleapis.com/v4/spreadsheets/1N2upLY61o3hxaW4rAgqBjx7U1LntsmLutXE9LTAwCy8/values/top20weekly!A2:K100?key=AIzaSyBn2U8krqzA8EZrKk2Ca6HXA3JHj0Y76F0", function( data ) {
    employeeData = data;
    console.log(data);
        
    var table = $('<table class="top20"></table>');

    table.append($('<tr><th>本周排名</th><th>上週排名</th><th>中文片名</th><th>上映週數</th><th>觀影人次</th><th>跌幅</th><th>本周票房</th><th>累積人次</th><th>累積票房</th><th>國別</th>'))
  for(i=0;i<data.values.length;i++){
//    var employeeName = data.values[i][0];
    var employee = employeeData.values[i];
      table.append($('<tr><td>' + employee[1] + '</td><td>' + employee[2] + '</td><td>' + employee[3] + '</td><td>' + employee[4] + '</td><td>' + employee[5] + '</td><td>' + employee[6] + '</td><td>' + employee[7] + '</td><td>' + employee[8] + '</td><td>' + employee[9] + '</td><td>' + employee[10] + '</td>'))
    }

    $('#weekly_table').html('')
    $('#weekly_table').append(table);    
 
  });  
  
  });
         





 </script>
 
 </body>
</html>
